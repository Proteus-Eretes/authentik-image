version: 1
metadata:
  name: Proteus - Password change flow
entries:
  - id: flow-changepassword
    model: authentik_flows.flow
    identifiers:
      slug: changepassword
    attrs:
      designation: stage_configuration
      name: Change Password
      title: Change password
  - id: prompt-field-password
    model: authentik_stages_prompt.prompt
    identifiers:
      field_key: password
      label: Password
    attrs:
      order: 300
      placeholder: Password
      placeholder_expression: false
      required: true
      type: password
  - id: prompt-field-password-repeat
    model: authentik_stages_prompt.prompt
    identifiers:
      field_key: password_repeat
      label: Password (repeat)
    attrs:
      order: 301
      placeholder: Password (repeat)
      placeholder_expression: false
      required: true
      type: password
  - id: promptstage-passwordchange
    model: authentik_stages_prompt.promptstage
    identifiers:
      name: proteus-password-change-prompt
    attrs:
      fields:
        - !KeyOf prompt-field-password
        - !KeyOf prompt-field-password-repeat
  - id: writestage-passwordchange
    model: authentik_stages_user_write.userwritestage
    identifiers:
      name: proteus-password-change-write
  - id: flowbinding-changepassword-prompt
    model: authentik_flows.flowstagebinding
    identifiers:
      order: 0
      stage: !KeyOf promptstage-passwordchange
      target: !KeyOf flow-changepassword
  - id: flowbinding-changepassword-write
    model: authentik_flows.flowstagebinding
    identifiers:
      order: 1
      stage: !KeyOf writestage-passwordchange
      target: !KeyOf flow-changepassword
